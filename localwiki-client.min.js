!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.LocalWiki=e()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;len>i;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},{}],2:[function(_dereq_,module){"use strict";function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?obj[k].map(function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},{}],3:[function(_dereq_,module,exports){"use strict";exports.decode=exports.parse=_dereq_("./decode"),exports.encode=exports.stringify=_dereq_("./encode")},{"./decode":1,"./encode":2}],4:[function(_dereq_,module){function LocalWikiClient(options,cb){return this instanceof LocalWikiClient?(options||(options={}),this.host=options.host||"http://localwiki.net",this.apiVersion=options.apiVersion||"v4",this.url=this.host+"/api/"+this.apiVersion+"/",this.apiKey=options.apiKey,void(cb&&this.apiRoot(cb))):new LocalWikiClient(opts)}var request=_dereq_("request"),qs=_dereq_("querystring");module.exports=LocalWikiClient,LocalWikiClient.prototype.apiRoot=function(cb){this._request("get","",cb)},LocalWikiClient.prototype.list=function(resource,params,cb){this._request("get",resource,params,cb)},LocalWikiClient.prototype.fetch=function(resource,id,params,cb){this._request("get",resource+"/"+id,params,cb)},LocalWikiClient.prototype.create=function(resource,params,cb){this._request("post",resource,params,cb)},LocalWikiClient.prototype.update=function(resource,id,params,cb){this._request("put",resource+"/"+id,params,cb)},LocalWikiClient.prototype.destroy=function(resource,id,params,cb){this._request("delete",resource+"/"+id,params,cb)},LocalWikiClient.prototype._request=function(type,resource,params,cb){function getResponse(error,response,body){return cb?error?cb(error):response.statusCode>=400?cb(response):"Not found"===body.detail?cb(body):cb(null,body):void 0}"function"==typeof params&&(cb=params,params={});var options={};options.headers={"Content-Type":"application/json"},"get"!==type&&(options.body=JSON.stringify(params),options.headers.Authorization="Token "+this.apiKey,params=null),options.url=this.fullUrl(resource,params),options.method=type,options.json=!0,request(options,getResponse)},LocalWikiClient.prototype.fullUrl=function(resource,params){var frag=resource.length>0?resource+"/":"";return this.region&&params&&!params.region&&(params.region=this.region),frag+=params?"?"+qs.stringify(params):"",this.url+frag}},{querystring:3,request:5}],5:[function(_dereq_,module){function createXHR(options,callback){function readystatechange(){4===xhr.readyState&&load()}function load(){var error=null,status=xhr.statusCode=xhr.status,body=null;if(xhr.response?body=xhr.body=xhr.response:"text"!==xhr.responseType&&xhr.responseType||(body=xhr.body=xhr.responseText||xhr.responseXML),1223===status&&(status=204),0===status||status>=400&&600>status){var message=("string"==typeof body?body:!1)||messages[String(xhr.status).charAt(0)];error=new Error(message),error.statusCode=xhr.status}if(isJson)try{body=xhr.body=JSON.parse(body)}catch(e){}callback(error,xhr,body)}function error(evt){callback(evt,xhr)}"string"==typeof options&&(options={uri:options}),options=options||{},callback=once(callback);var xhr=options.xhr||null;!xhr&&options.cors?xhr=new XDR:xhr||(xhr=new XHR);var key,uri=xhr.url=options.uri||options.url,method=xhr.method=options.method||"GET",body=options.body||options.data,headers=xhr.headers=options.headers||{},sync=!!options.sync,isJson=!1;if("json"in options&&(isJson=!0,headers.Accept="application/json","GET"!==method&&"HEAD"!==method&&(headers["Content-Type"]="application/json",body=JSON.stringify(options.json))),xhr.onreadystatechange=readystatechange,xhr.onload=load,xhr.onerror=error,xhr.onprogress=function(){},xhr.ontimeout=noop,xhr.open(method,uri,!sync),options.cors&&options.withCredentials!==!1&&(xhr.withCredentials=!0),sync||(xhr.timeout="timeout"in options?options.timeout:5e3),xhr.setRequestHeader)for(key in headers)headers.hasOwnProperty(key)&&xhr.setRequestHeader(key,headers[key]);return"responseType"in options&&(xhr.responseType=options.responseType),"beforeSend"in options&&"function"==typeof options.beforeSend&&options.beforeSend(xhr),xhr.send(body),xhr}function noop(){}var window=_dereq_("global/window"),once=_dereq_("once"),messages={0:"Internal XMLHttpRequest Error",4:"4xx Client Error",5:"5xx Server Error"},XHR=window.XMLHttpRequest||noop,XDR="withCredentials"in new XHR?window.XMLHttpRequest:window.XDomainRequest;module.exports=createXHR},{"global/window":6,once:7}],6:[function(_dereq_,module){(function(global){module.exports="undefined"!=typeof window?window:"undefined"!=typeof global?global:{}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(_dereq_,module){function once(fn){var called=!1;return function(){return called?void 0:(called=!0,fn.apply(this,arguments))}}module.exports=once,once.proto=once(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return once(this)},configurable:!0})})},{}]},{},[4])(4)});